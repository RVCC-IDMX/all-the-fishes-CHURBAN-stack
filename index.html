<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>My Fish Tank</title>
    <script src="https://pixijs.download/release/pixi.min.js"></script>
  </head>
  <body>
    <script>
      //The App
      var app = new PIXI.Application({
        width: 640,
        height: 480,
        backgroundColor: 0x000000,
      });

      //Add view to the document
      document.body.appendChild(app.view);

      //Background
      let background = PIXI.Sprite.from("img/background.jpg");
      background.scale.set(0.35);
      background.x = -100;
      background.y = -100;
      app.stage.addChild(background);

      //My first sprite
      let fish1 = PIXI.Sprite.from("img/lepomis-cyanellus.gif");
      fish1.scale.set(0.25);
      fish1.x = -200;
      fish1.y = 0;
      fish1.angle = 20;
      fish1.tint = 0xffffff;
      fish1.y = 10;

      //My second sprite
      let fish2 = PIXI.Sprite.from("img/fish.png");
      fish2.x = 10;
      fish2.y = 100;
      fish2.scale.set(0.1);
      fish2.tint = 0xffd700;

      //Seaweed
      let seaweed = PIXI.Sprite.from("img/seaweed.png");
      seaweed.x = 200;
      seaweed.y = 200;
      seaweed.scale.set(0.25);

      //My third sprite
      let fish3 = PIXI.Sprite.from("img/colorful-fish1.png");
      fish3.x = -25;
      fish3.y = 10;
      fish3.scale.set(0.085);
 
      //Add it to the stage!
      app.stage.addChild(fish1);
      app.stage.addChild(fish2);
      app.stage.addChild(fish3);
      app.stage.addChild(seaweed);

      //My container
      var my_container = new PIXI.Container();
      my_container.addChild(fish1);
      my_container.addChild(fish2);
      my_container.addChild(fish3);
      my_container.interactive = true; 
      my_container.x = 320;
      my_container.y = 240;
      

      app.stage.addChild(my_container);

      //Animation loop!
      function animationLoop() {
        let time = Date.now();

        let wobble1 = Math.sin(time / 1000) * 15;
        let wobble2 = Math.sin(time / 700) * 50;
        let wobble3 = Math.cos(time / 1200) * 50;
        fish1.y = wobble1;
        fish2.y = wobble2;
        fish3.y = wobble3;

        setTimeout(animationLoop, 1000 / 30);
      }
      animationLoop();

     // Button forchanging button
    let ourButton = new PIXI.Container();
    ourButton.interactive = true;

    let buttonBody = new PIXI.Graphics();
    buttonBody.beginFill(0xEEEE);
    buttonBody.drawRect(0,0,100,50);
    buttonBody.alpha = .7;
    ourButton.addChild(buttonBody);

    ourButton.body = buttonBody;

    let buttonText = new PIXI.Text('Colors');
    buttonText.anchor.set(.5,.5);
    buttonText.x = 50;
    buttonText.y = 25;
    ourButton.addChild(buttonText);
    ourButton.text = buttonText;

    // Code for the Color Changing button
    ourButton.on("click",function (e){
        let randomColor = Math.floor(Math.random()*0xFFFFFF);
        fish2.tint= randomColor;
        //console.log(randomColor);
        //console.log("clicked");
    });

    ourButton.on("click",function (e){
        let randomColor = Math.floor(Math.random()*0xFFFFFF);
        fish2.tint= randomColor;
        //console.log(randomColor);
        //console.log("clicked");
    });

    app.stage.addChild(ourButton);

    // Fish 3 dragging Code: 
    function makeButton(){
    //fish3.x = app.view.width; 
    //fish3.y = app.view.height/2; 
    fish3.interactive = true;
    

    //Drag fish3
    fish3.dragging = false;
    fish3.on("pointerdown", function (e){
        fish3.dragging = true;
        console.log('click');
    })
    fish3.on("pointermove", function (e) {
        if(fish3.dragging){
            console.log("dragging");
            fish3.x = e.data.global.x - fish3.width*5;
            fish3.y = e.data.global.y - fish3.height*5;
        };
    })
    fish3.on("pointerup", function (e) {
        fish3.dragging = false;
    })
    fish3.on("pointerupoutside", function (e){
        fish3.dragging = false;
    })

  }
  makeButton();

// Slider on Top of the TV Scren: 
function makeSlider() {
    let slideContain = new PIXI.Container();
    slideContain.interactive = true;
    slideContain.value = 0;
    
    let track = new PIXI.Graphics();
    track.beginFill(0xEEEE);
    track.drawRect(200,-10,300,20);

    slideContain.addChild(track);

    let slide = new PIXI.Graphics();
    slide.interactive = true;
    slide.beginFill(0xEEEEEE);
    slide.drawRect(175,-25,50,50);
    slideContain.addChild(slide);

    // Event listeners
    slide.dragging = false;
    slide.on("pointerdown", function (e){
        slide.dragging = true;
        console.log('click');
    });
    slide.on("pointermove", function (e) {
        if(slide.dragging){
            let newX = e.data.global.x - slideContain.getGlobalPosition().x - 200;
            let newY = e.data.global.y - slideContain.getGlobalPosition().y;
            
            if (newX > track.width) newX = track.width;
            if (newX < 0 )newX = 0;

            slideContain.value = newX/track.width;
            slide.x = newX;
            fish1.scale.set(newX/1200);
            //console.log(slideContain.value);
        }
    });
    slide.on("pointerup", function (e) {
        slide.dragging = false;
    });
    slide.on("pointerupoutside", function (e){
        slide.dragging = false;
    });
    return slideContain;
};
let slideContain = makeSlider();
app.stage.addChild(slideContain);

    </script>
  </body>
</html>